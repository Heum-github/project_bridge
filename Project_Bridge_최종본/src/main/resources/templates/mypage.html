<!DOCTYPE html>
<html lang="en">
<head>
<title>Pet Sitting - Free Bootstrap 4 Template by Colorlib</title>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
	crossorigin="anonymous">
<!-- <link
	href="https://fonts.googleapis.com/css?family=Montserrat:200,300,400,500,600,700,800&display=swap"
	rel="stylesheet"> -->
<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="css/animate.css">
<link rel="stylesheet" href="css/owl.carousel.min.css">
<link rel="stylesheet" href="css/owl.theme.default.min.css">
<link rel="stylesheet" href="css/magnific-popup.css">
<link rel="stylesheet" href="css/bootstrap-datepicker.css">
<link rel="stylesheet" href="css/jquery.timepicker.css">
<link rel="stylesheet" href="css/flaticon.css">
<link rel="stylesheet" href="css/style.css">

</head>
<body style="font-family: 'Pretendard-Regular';">
	<!-- Header -->
	<div th:replace="/header :: header"></div>
	<!-- END nav -->
	<section class="hero-wrap hero-wrap-2"
		data-stellar-background-ratio="0.5">
		<div class="overlay overlay-new"></div>
		<div class="container">
			<div class="profilemodal hidden"></div>
			<div class="row row2 no-gutters slider-text align-items-end">
				<div class="col-md-9 ftco-animate pb-5" style="margin-top: 10px;">
					<h1 class="mb-0 bread page-name">MYPAGE</h1>
				</div>
				<div class="container-bar- ftco-animate fadeInUp ftco-animated">
					<div class="bar-bar ftco-animate fadeInUp ftco-animated"></div>
				</div>
			</div>
		</div>
	</section>
	<br>
	<section class="ftco-section ftco-degree-bg">
		<div class="container">
			<div class="row">
				<div class="col-lg-8 ftco-animate">
					<span class="span_label" style = "font-size : 20px;">프로필카드 미리보기</span> <br><br>
					<div>
						<div class="profilemodal2">
							<div class="container">
								<div class="col-md-6">
									<div class="profile cdRotate" style="margin-bottom: 40px">
										<div class="cdCenter"></div>
									</div>
									<div class="profile-container">
										<div class="user_nick profile-title">닉네임</div>
										<div class="profile-content"
											th:text="${session.loginUser.user_id}"></div>
									</div>
									<div class="profile-container">
										<div class="song_genre profile-title">나이</div>
										<div class="profile-content"
											th:text="${session.loginUser.user_birthday}"></div>
									</div>
									<div class="profile-container">
										<div class="user_singer profile-title">좋아하는 가수</div>
										<div class="profile-content"
											th:text="${session.loginUser.user_fav}"></div>
									</div>
									<div class="profile-container">
										<div class="user_text profile-title">소개</div>
										<div class="profile-content"
											th:text="${session.loginUser.user_intro}"></div>
									</div>
									<a href="#"><button class="btn btn-primary">채팅하기</button></a>
									<button class="btn btn-primary" id="closemodal">닫기</button>
								</div>
								<div class="col-md-6"
									style="border: 1px solid white; border-radius: 30px;">
									<h3 class="profile-list-title">업로드한 노래</h3>
									<ul class="profile-list profilesong" style="padding: 0;"
										th:each="b : ${musics}">
										<audio controls>
											<source src=th:src=
												"@{'data:audio/mp3;base64, '} + ${b.song_file}"
													type="audio/mpeg">
										</audio>
										<span class="profile-list-item" th:text="${b.user_song_name}"></span>
										<span> - </span>
										<span class="profile-list-item" th:text="${b.user_singer}"></span>
										<br>
										<br>
									</ul>
								</div>
							</div>
						</div>
					</div>

					<br> <br>
					<!-- 회원정보 수정 -->
					<form method="POST" action="user/update" id="contactForm"
						name="contactForm" class="contactForm">
						<div>
							<div class="col-md-8">
								<div class="form-group">
									<label class="label label_color mypage_label" for="user_id">아이디(이메일)</label>
									<input type="email" class="form-control" name="user_id"
										id="user_id" th:value="${session.loginUser.user_id}" readonly>
								</div>
							</div>
							<div class="row">
								<div class="col-md-6">
									<div class="form-group" style = "padding-left : 15px;">
										<label class="label mypage_label" for="user_name">이름</label> <input
											type="text" class="form-control" name="user_name"
											id="user_name" th:value="${session.loginUser.user_name}">
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="label mypage_label" for="user_nick">닉네임</label>
										<input type="text" class="form-control" name="user_nick"
											id="user_nick" th:value="${session.loginUser.user_nick}">
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-6">
									<div class="form-group" style = "padding-left : 15px;">
										<label class="label mypage_label" for="user_pw">비밀번호
											수정</label>
										<!-- 히든으로 세션의 비밀번호 정보 가지고 있는 것도 괜찮을듯. -->
										<input type="password" class="form-control" name="user_pw"
											id="user_pw" th:value="${session.loginUser.user_pw}">
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-group">
										<label class="label mypage_label" for="user_birthday">생년월일</label>
										<input type="date" class="form-control" name="user_birthday"
											id="user_birthday"
											th:value="${session.loginUser.user_birthday}">
									</div>
								</div>
							</div>
							<div class="col-md-8">
								<div class="form-group">
									<label class="label mypage_label" for="subject">주소</label>
									<div style = "display: flex; flex-direction: row; gap : 5px">
										<input type="text" class="form-control" name="user_address"
											id="sample5_address"
											th:value="${session.loginUser.user_address}"> <br>
										<input type="button" class="btn btn-secondary"
											onclick="sample5_execDaumPostcode()" value="주소 검색">
										<div id="map"
											style="width: 300px; height: 300px; margin-top: 10px; display: none"></div>
									</div>
								</div>
							</div>
							<div class="col-md-8">
								<div class="form-group">
									<label class="label label_color mypage_label" for="user_fav">좋아하는 가수</label>
									<input type="text" class="form-control" name="user_fav"
										id="user_fav" th:value="${session.loginUser.user_fav}">
								</div>
							</div>
							<div class="col-md-12">
								<div class="form-group">
									<label class="label mypage_label" for="user_intro">한 줄 소개</label>
									<textarea name="user_intro" class="form-control" id="message"
										cols="30" rows="1" th:value="${session.loginUser.user_intro}"></textarea>
								</div>
							</div>
							<div class="col-md-12">
								<div class="form-group">
									<input type="submit" value="회원 정보 수정" class="btn btn-primary">
									<div class="submitting"></div>
								</div>
							</div>
						</div>
					</form>
					<a id="deleteBtn" style="margin-left: 15px;"><input
						id="deleteUser" type="submit" class="btn btn-primary"
						value="회원 탈퇴"></a>
				</div>
				<!-- .col-md-8 -->
				<div class="col-lg-4 sidebar pl-lg-5 ftco-animate">
					<br> <br>
					<div class="sidebar-box ftco-animate">
						<div style = "display: flex; flex-direction: row; justify-content: space-between;">
							<h3 class="fon_gra">업로드한 노래</h3>
							<a class="btn btn-primary" href="uploadmusic">노래 업로드하기</a> <br>
						</div>
						<br>
						<div class="block-21 mb-4 d-flex" th:each="b : ${musics}">
							<div class="text">
								<audio controls>
									<source th:src="@{'data:audio/mp3;base64, '} + ${b.song_file}"
										type="audio/ogg">
									<source src="/examples/media/sample_audio_mp3.mp3"
										type="audio/mpeg">
								</audio>
								<h4 class="heading">
									<span th:text="${b.user_song_name}"></span> <span> - </span> <span
										th:text="${b.user_singer}"></span>
								</h4>
							</div>
						</div>
						<nav aria-label="Page navigation example">
							<div class="pagination d-flex justify-content-center">
								<span class="page-item" th:if="${page > 1}"> <a
									class="page-link" th:href="@{/mypage(page=${page - 1})}">Previous</a></span>
								<span class="page-item"
									th:each="pageNumber : ${#numbers.sequence(1, totalPages)}">
									<a class="page-link" th:href="@{/mypage(page=${pageNumber})}"
									th:text="${pageNumber}"></a>
								</span> <span class="page-item" th:if="${page < totalPages}"> <a
									class="page-link" th:href="@{/mypage(page=${page + 1})}">Next</a>
								</span>
							</div>
						</nav>

					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- footer -->
	<div th:replace="/footer :: footer"></div>
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
		crossorigin="anonymous"></script>
	<script src="js/jquery.min.js"></script>
	<script src="js/jquery-migrate-3.0.1.min.js"></script>
	<script src="js/popper.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/jquery.easing.1.3.js"></script>
	<script src="js/jquery.waypoints.min.js"></script>
	<script src="js/jquery.stellar.min.js"></script>
	<script src="js/owl.carousel.min.js"></script>
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/scrollax.min.js"></script>
	<script src="js/main.js"></script>
	<script src="https://kit.fontawesome.com/8fba072206.js"></script>
	<script src="js/move-div.js"></script>

	<!-- 카카오맵 API -->
	<script
		src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
	<!-- 우편번호 받는 API -->
	<script
		src="//dapi.kakao.com/v2/maps/sdk.js?appkey=a0080ec850b9ee7cb65ff959024ac67d&libraries=services"></script>
	<script>
		var mapContainer = document.getElementById('map'), // 지도를 표시할 div   
		mapOption = {
			center : new daum.maps.LatLng(37.537187, 127.005476), // 지도의 중심좌표
			level : 5
		// 지도의 확대 레벨
		};

		//지도를 미리 생성
		var map = new daum.maps.Map(mapContainer, mapOption);
		//주소-좌표 변환 객체를 생성
		var geocoder = new daum.maps.services.Geocoder();
		//마커를 미리 생성
		var marker = new daum.maps.Marker({
			position : new daum.maps.LatLng(37.537187, 127.005476), // 중심좌표에 마커 생성
			map : map
		});

		// 버튼 클릭 시 작동하는 function()
		function sample5_execDaumPostcode() {
			new daum.Postcode({
				oncomplete : function(data) {
					var addr = data.address; // 최종 주소 변수

					// 입력한 주소 가져오기
					document.getElementById("sample5_address").value = addr;
					// 주소로 상세 정보를 검색
					geocoder.addressSearch(data.address, function(results,
							status) {
						// 정상적으로 검색이 완료됐으면
						if (status === daum.maps.services.Status.OK) {

							var result = results[0]; //첫번째 결과의 값을 활용

							// 해당 주소에 대한 좌표를 coords에 저장
							var coords = new daum.maps.LatLng(result.y,
									result.x);
							// 지도를 보여준다.
							mapContainer.style.display = "none";
							map.relayout();
							// 지도 중심을 변경한다.
							map.setCenter(coords);
							// 마커를 결과값으로 받은 위치로 옮긴다.
							marker.setPosition(coords)
						}
					});
				}
			}).open();
		}
		const deleteBtn = document.querySelector("#deleteBtn");
		deleteBtn.addEventListener("click", () => {
		    if(confirm("정말로 회원 탈퇴를 진행하시겠습니까?")){
		        location.href = "http://localhost:8090/bridge/deleteUser"
		        alert("회원탈퇴가 완료되었습니다.")
		    } else {
		        location.href = "http://localhost:8090/bridge/mypage"
		    }        

		})

	</script>
	<script src="js/navbar-move-div.js"></script>
</body>
</html>